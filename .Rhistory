}, error = function(e) {
message("❌ BŁĄD: Nie można wczytać pliku! Jest uszkodzony.")
message("Treść błędu: ", e$message)
})
} else {
message("❌ BŁĄD: Plik ", file_path, " nie istnieje!")
}
load("data/raw/TCGA_LAML_Raw.RData")
View(data_rna)
View(data_rna)
View(clinical_data)
View(clinical_data)
View(clinical_patient)
View(clinical_patient)
View(data_rna)
View(data_rna)
data_rna
source("scripts/02_preprocessing.R")
renv::install("edgeR")
source("scripts/02_preprocessing.R")
source("scripts/02_preprocessing.R")
# Wczytanie danych
load("data/raw/TCGA_LAML_Raw.RData")
# Szukamy kolumn pasujących do wzorca
candidates <- grep("morphology|french", colnames(clinical_patient), value = TRUE, ignore.case = TRUE)
message("--- DOKŁADNE NAZWY KOLUMN (Kopiuj stąd!) ---")
print(candidates)
# Sprawdźmy też, co w nich siedzi (pierwsze 5 wartości)
if(length(candidates) > 0) {
message("\n--- ZAWARTOŚĆ PIERWSZEJ ZNALEZIONEJ KOLUMNY ---")
print(table(clinical_patient[[candidates[1]]]))
}
load("data/raw/TCGA_LAML_Raw.RData")
message("--- SZUKANIE KOLUMNY Z DIAGNOZAMI (M1, M2, M3...) ---")
# Sprawdzamy każdą kolumnę: czy zawiera wartość "M3" (charakterystyczny podtyp)?
# To zwróci nazwę kolumny, która ma w środku "M3"
found_col <- colnames(clinical_patient)[apply(clinical_patient, 2, function(x) any(grepl("M3", x, fixed=TRUE)))]
if(length(found_col) > 0) {
message("✅ ZNALEZIONO KOLUMNĘ: ", found_col)
message("--- Przykładowe wartości: ---")
print(table(clinical_patient[[found_col[1]]]))
} else {
message("❌ Nie znaleziono żadnej kolumny zawierającej 'M3'.")
message("Dostępne kolumny to:")
print(colnames(clinical_patient))
}
source("scripts/02_preprocessing.R")
source("scripts/03_feature_selection.R")
renv::install("Boruta")
source("scripts/03_feature_selection.R")
renv::install("caret")
source("scripts/03_feature_selection.R")
source("scripts/04_modeling.R")
renv::install("randomForest")
source("scripts/04_modeling.R")
source("scripts/04_modeling.R")
source("scripts/04_modeling.R")
source("scripts/04_modeling.R")
source("scripts/04_modeling.R")
source("scripts/04_modeling.R")
source("scripts/04_modeling.R")
source("scripts/04_modeling.R")
source("scripts/04_modeling_test.R")
getwd()
source("scripts/04_modeling_test.R")
library(shiny); runApp('scripts/05_GUI.R')
runApp('scripts/05_GUI.R')
runApp('scripts/05_GUI.R')
runApp('scripts/05_GUI.R')
runApp('scripts/05_GUI.R')
runApp('scripts/05_GUI.R')
runApp('scripts/05_GUI.R')
runApp('scripts/05_GUI.R')
runApp('scripts/05_GUI.R')
runApp('scripts/05_GUI.R')
runApp('scripts/05_GUI.R')
# SKRYPT 06: Generowanie Wykresów do Pracy Dyplomowej
# ------------------------------------------------------------------------------
# Cel: Zapis wysokiej jakości wykresów (PNG/PDF) do wklejenia w Wordzie/LaTeX.
# ------------------------------------------------------------------------------
library(ggplot2)
library(caret)
library(Boruta)
library(pheatmap)
library(dplyr)
# 1. Wczytanie danych
load("results/models/Boruta_Results.RData")
load("results/models/Final_Models.RData")
if(!dir.exists("results/plots")) dir.create("results/plots", recursive = TRUE)
message("Generowanie wykresów do pracy...")
# --- WYKRES 1: Ranking Genów (Boruta Importance) ---
# To pokazuje "proces selekcji".
pdf("results/plots/01_Boruta_Importance.pdf", width = 8, height = 6)
plot(boruta_output, xlab = "", xaxt = "n", main = "Ważność cech wg algorytmu Boruta")
lz <- lapply(1:ncol(boruta_output$ImpHistory), function(i)
boruta_output$ImpHistory[is.finite(boruta_output$ImpHistory[,i]),i])
axis(side = 1, las=2, labels = names(boruta_output$finalDecision),
at = 1:ncol(boruta_output$ImpHistory), cex.axis = 0.7)
runApp('scripts/05_GUI.R')
runApp('scripts/05_GUI.R')
runApp('scripts/05_GUI.R')
library(shiny); runApp('scripts/05_GUI.R')
# SKRYPT 06: Generowanie Wykresów do Pracy Dyplomowej
# ------------------------------------------------------------------------------
# Cel: Stworzenie profesjonalnych wykresów (ggplot2) do rozdziału "Wyniki".
# Output: Pliki PNG/PDF w folderze results/plots/
# ------------------------------------------------------------------------------
library(ggplot2)
library(caret)
library(Boruta)
library(pheatmap)
library(dplyr)
library(gridExtra) # Do układania wykresów
renv::install("gridExtra")
# SKRYPT 06: Generowanie Wykresów do Pracy Dyplomowej
# ------------------------------------------------------------------------------
# Cel: Stworzenie profesjonalnych wykresów (ggplot2) do rozdziału "Wyniki".
# Output: Pliki PNG/PDF w folderze results/plots/
# ------------------------------------------------------------------------------
library(ggplot2)
library(caret)
library(Boruta)
library(pheatmap)
library(dplyr)
library(gridExtra) # Do układania wykresów
library(RColorBrewer) # Ładne palety kolorów
# 1. Wczytanie wyników z poprzednich etapów
# Upewnij się, że te pliki istnieją!
load("results/models/Boruta_Results.RData") # Zawiera: ml_data_final, boruta_output
load("results/models/Final_Models.RData")   # Zawiera: results, cm_rf, model_rf
# Tworzymy folder na wykresy
if(!dir.exists("results/plots")) dir.create("results/plots", recursive = TRUE)
message(">>> Generowanie wykresów do pracy magisterskiej... <<<")
# ==============================================================================
# WYKRES 1: ROZKŁAD KLAS (Uzasadnienie odrzucenia M6/M7)
# ==============================================================================
# Korzystamy z pełnych danych (ml_data_final), żeby pokazać nierównowagę
class_dist <- as.data.frame(table(ml_data_final$Target))
colnames(class_dist) <- c("Podtyp", "Liczba")
p1 <- ggplot(class_dist, aes(x = Podtyp, y = Liczba, fill = Podtyp)) +
geom_col(color = "black", alpha = 0.8) +
geom_text(aes(label = Liczba), vjust = -0.5, size = 5) +
scale_fill_brewer(palette = "Set3") +
labs(title = "Liczebność podtypów białaczki w analizowanym zbiorze",
subtitle = "Widoczna nierównowaga klas i mała liczebność M6/M7",
x = "Podtyp morfologiczny (FAB)", y = "Liczba pacjentów") +
theme_classic() +
theme(legend.position = "none",
plot.title = element_text(face = "bold", size = 14))
ggsave("results/plots/01_Class_Distribution.png", plot = p1, width = 8, height = 5, dpi = 300)
message("-> Zapisano: 01_Class_Distribution.png")
# ==============================================================================
# WYKRES 2: PCA (Wizualizacja przestrzeni cech)
# ==============================================================================
# Obliczamy PCA na 150 wybranych genach
pca_res <- prcomp(ml_data_final[, -ncol(ml_data_final)], scale. = TRUE)
pca_df <- data.frame(PC1 = pca_res$x[,1], PC2 = pca_res$x[,2], Target = ml_data_final$Target)
p2 <- ggplot(pca_df, aes(x = PC1, y = PC2, color = Target)) +
geom_point(size = 3, alpha = 0.7) +
stat_ellipse(level = 0.95, linetype = 2, size = 0.5) + # Dodajemy elipsy dla grup
labs(title = "Analiza Głównych Składowych (PCA)",
subtitle = "Rzutowanie 150 wymiarów (genów) na płaszczyznę 2D",
x = paste0("PC1 (", round(summary(pca_res)$importance[2,1]*100, 1), "%)"),
y = paste0("PC2 (", round(summary(pca_res)$importance[2,2]*100, 1), "%)"),
color = "Podtyp") +
theme_bw()
ggsave("results/plots/02_PCA_Analysis.png", plot = p2, width = 8, height = 6, dpi = 300)
message("-> Zapisano: 02_PCA_Analysis.png")
# ==============================================================================
# WYKRES 3: PORÓWNANIE MODELI (Dowód hipotezy)
# ==============================================================================
# Wyciągamy wyniki z obiektu 'results' (caret resamples)
model_comp <- summary(results)$statistics$Accuracy
comp_df <- data.frame(
Model = rownames(model_comp),
Mean_Accuracy = model_comp[, "Mean"],
Min = model_comp[, "Min."],
Max = model_comp[, "Max."]
)
p3 <- ggplot(comp_df, aes(x = reorder(Model, Mean_Accuracy), y = Mean_Accuracy, fill = Model)) +
geom_col(width = 0.6, color = "black", alpha = 0.8) +
geom_errorbar(aes(ymin = Min, ymax = Max), width = 0.2) + # Paski błędów (zakres)
coord_flip() + # Wykres poziomy
scale_fill_manual(values = c("Random_Forest" = "#2ca25f", "kNN" = "#8856a7", "SVM" = "#e34a33")) +
labs(title = "Porównanie skuteczności modeli (Walidacja Krzyżowa)",
subtitle = "Random Forest osiąga najwyższą średnią dokładność",
y = "Dokładność (Accuracy)", x = "Algorytm") +
theme_minimal() +
theme(legend.position = "none",
axis.text.y = element_text(size = 12, face = "bold"))
ggsave("results/plots/03_Model_Comparison.png", plot = p3, width = 8, height = 4, dpi = 300)
message("-> Zapisano: 03_Model_Comparison.png")
# ==============================================================================
# WYKRES 4: MACIERZ POMYŁEK (Gdzie Random Forest się myli?)
# ==============================================================================
# Używamy wyników z najlepszego modelu (Random Forest)
cm_data <- as.data.frame(cm_rf$table)
p4 <- ggplot(cm_data, aes(x = Reference, y = Prediction, fill = Freq)) +
geom_tile(color = "white") +
geom_text(aes(label = Freq), size = 6, fontface = "bold") +
scale_fill_gradient(low = "#f7fbff", high = "#08519c") +
labs(title = "Macierz Pomyłek - Random Forest",
subtitle = "Zbiór testowy (n=33)",
x = "Rzeczywista Diagnoza", y = "Predykcja Modelu") +
theme_minimal()
ggsave("results/plots/04_Confusion_Matrix.png", plot = p4, width = 6, height = 5, dpi = 300)
message("-> Zapisano: 04_Confusion_Matrix.png")
# ==============================================================================
# WYKRES 5: BIOLOGICZNY (Top Gen - HOXA9)
# ==============================================================================
# Znajdujemy najważniejszy gen wg Random Forest (MeanDecreaseGini)
# Wyciągamy ważność cech z modelu RF
importance_rf <- importance(model_rf$finalModel)
renv::install(c("gridExtra", "RColorBrewer"))
source("scripts/06_plots.R")
source("~/AML_Classification/scripts/06_plots.R")
source("scripts/06_plots.R")
# SKRYPT 06: Generowanie Wykresów do Pracy Dyplomowej
# ------------------------------------------------------------------------------
# Cel: Stworzenie profesjonalnych wykresów (ggplot2) do rozdziału "Wyniki".
# Output: Pliki PNG/PDF w folderze results/plots/
# ------------------------------------------------------------------------------
library(ggplot2)
library(caret)
library(Boruta)
library(pheatmap)
library(dplyr)
library(gridExtra)
library(RColorBrewer)
# 1. Wczytanie wyników z poprzednich etapów
# Upewnij się, że te pliki istnieją!
load("results/models/Boruta_Results.RData") # Zawiera: ml_data_final, boruta_output
load("results/models/Final_Models.RData")   # Zawiera: results, cm_rf, model_rf
# Tworzymy folder na wykresy
if(!dir.exists("results/plots")) dir.create("results/plots", recursive = TRUE)
message(">>> Generowanie wykresów do pracy magisterskiej... <<<")
# ==============================================================================
# WYKRES 1: ROZKŁAD KLAS (Uzasadnienie odrzucenia M6/M7)
# ==============================================================================
# Korzystamy z pełnych danych (ml_data_final), żeby pokazać nierównowagę
class_dist <- as.data.frame(table(ml_data_final$Target))
colnames(class_dist) <- c("Podtyp", "Liczba")
p1 <- ggplot(class_dist, aes(x = Podtyp, y = Liczba, fill = Podtyp)) +
geom_col(color = "black", alpha = 0.8) +
geom_text(aes(label = Liczba), vjust = -0.5, size = 5) +
scale_fill_brewer(palette = "Set3") +
labs(title = "Liczebność podtypów białaczki w analizowanym zbiorze",
subtitle = "Widoczna nierównowaga klas i mała liczebność M6/M7",
x = "Podtyp morfologiczny (FAB)", y = "Liczba pacjentów") +
theme_classic() +
theme(legend.position = "none",
plot.title = element_text(face = "bold", size = 14))
ggsave("results/plots/01_Class_Distribution.png", plot = p1, width = 8, height = 5, dpi = 300)
message("-> Zapisano: 01_Class_Distribution.png")
# ==============================================================================
# WYKRES 2: PCA (Wizualizacja przestrzeni cech)
# ==============================================================================
# Obliczamy PCA na 150 wybranych genach
pca_res <- prcomp(ml_data_final[, -ncol(ml_data_final)], scale. = TRUE)
pca_df <- data.frame(PC1 = pca_res$x[,1], PC2 = pca_res$x[,2], Target = ml_data_final$Target)
p2 <- ggplot(pca_df, aes(x = PC1, y = PC2, color = Target)) +
geom_point(size = 3, alpha = 0.7) +
stat_ellipse(level = 0.95, linetype = 2, size = 0.5) + # Dodajemy elipsy dla grup
labs(title = "Analiza Głównych Składowych (PCA)",
subtitle = "Rzutowanie 150 wymiarów (genów) na płaszczyznę 2D",
x = paste0("PC1 (", round(summary(pca_res)$importance[2,1]*100, 1), "%)"),
y = paste0("PC2 (", round(summary(pca_res)$importance[2,2]*100, 1), "%)"),
color = "Podtyp") +
theme_bw()
ggsave("results/plots/02_PCA_Analysis.png", plot = p2, width = 8, height = 6, dpi = 300)
message("-> Zapisano: 02_PCA_Analysis.png")
# ==============================================================================
# WYKRES 3: PORÓWNANIE MODELI (Dowód hipotezy)
# ==============================================================================
# Wyciągamy wyniki z obiektu 'results' (caret resamples)
model_comp <- summary(results)$statistics$Accuracy
comp_df <- data.frame(
Model = rownames(model_comp),
Mean_Accuracy = model_comp[, "Mean"],
Min = model_comp[, "Min."],
Max = model_comp[, "Max."]
)
p3 <- ggplot(comp_df, aes(x = reorder(Model, Mean_Accuracy), y = Mean_Accuracy, fill = Model)) +
geom_col(width = 0.6, color = "black", alpha = 0.8) +
geom_errorbar(aes(ymin = Min, ymax = Max), width = 0.2) + # Paski błędów (zakres)
coord_flip() + # Wykres poziomy
scale_fill_manual(values = c("Random_Forest" = "#2ca25f", "kNN" = "#8856a7", "SVM" = "#e34a33")) +
labs(title = "Porównanie skuteczności modeli (Walidacja Krzyżowa)",
subtitle = "Random Forest osiąga najwyższą średnią dokładność",
y = "Dokładność (Accuracy)", x = "Algorytm") +
theme_minimal() +
theme(legend.position = "none",
axis.text.y = element_text(size = 12, face = "bold"))
ggsave("results/plots/03_Model_Comparison.png", plot = p3, width = 8, height = 4, dpi = 300)
message("-> Zapisano: 03_Model_Comparison.png")
# ==============================================================================
# WYKRES 4: MACIERZ POMYŁEK (Gdzie Random Forest się myli?)
# ==============================================================================
# Używamy wyników z najlepszego modelu (Random Forest)
cm_data <- as.data.frame(cm_rf$table)
p4 <- ggplot(cm_data, aes(x = Reference, y = Prediction, fill = Freq)) +
geom_tile(color = "white") +
geom_text(aes(label = Freq), size = 6, fontface = "bold") +
scale_fill_gradient(low = "#f7fbff", high = "#08519c") +
labs(title = "Macierz Pomyłek - Random Forest",
subtitle = "Zbiór testowy (n=33)",
x = "Rzeczywista Diagnoza", y = "Predykcja Modelu") +
theme_minimal()
ggsave("results/plots/04_Confusion_Matrix.png", plot = p4, width = 6, height = 5, dpi = 300)
message("-> Zapisano: 04_Confusion_Matrix.png")
# ==============================================================================
# WYKRES 5: BIOLOGICZNY (Top Gen - HOXA9)
# ==============================================================================
# Znajdujemy najważniejszy gen wg Random Forest (MeanDecreaseGini)
# Wyciągamy ważność cech z modelu RF
importance_rf <- importance(model_rf$finalModel)
library(shiny); runApp('scripts/05_GUI.R')
getwd()
setwd(""C:\Users\kwiat\OneDrive\Dokumenty\polyp_segmentation"")
setwd(C:/Users/kwiat/OneDrive/Dokumenty/polyp_segmentation")
setwd(C:\Users\kwiat\OneDrive\Dokumenty\polyp_segmentation")
setwd("C:\Users\kwiat\OneDrive\Dokumenty\polyp_segmentation")
setwd("C:/Users/kwiat/OneDrive/Dokumenty/polyp_segmentation")
getwd()
source("install_dependencies.R")
renv::status()
source("scripts/01_data_download.R")
source("scripts/02_preprocessing.R")
source("scripts/03_feature_selection.R")
source("scripts/04_modeling.R")
shiny::runApp("scripts/05_GUI.R")
source("06_plots")
source("scripts/06_plots")
source("scripts/06_plots.R")
View(clinical_data)
View(clinical_data)
colnames(clinical_patient)
clinical_data[["clinical_patient_laml"]][["fab_category"]]
table(clinical_patient$fab_classification)
table(clinical_patient$fab_category)
# Główną tabela pacjentów
clinical_patient <- clinical_data$clinical_patient_laml
#Zosatwienie tylko klas od M0 to M5 ze wzgledu na małą liczbe probek dla M6 oraz M7
keep_fab <- c("M0 Undifferentiated", "M1", "M2", "M3", "M4", "M5")
# Główną tabela pacjentów
clinical_patient <- clinical_data$clinical_patient_laml
# SKRYPT 01: Data Download (TCGA-LAML)
# ------------------------------------------------------------------------------
# Pobranie danych klinicznych i transkryptomicznych (RNA-seq)
# Źródło: GDC (Genomic Data Commons)
# ------------------------------------------------------------------------------
library(TCGAbiolinks)
library(SummarizedExperiment)
message(">>> ROZPOCZYNANIE POBIERANIA DANYCH DLA PROJEKTU TCGA-LAML <<<")
# Utworzenie folderu na pliki tymczasowe
if(!dir.exists("GDCdata")) dir.create("GDCdata")
# --- 1. DANE KLINICZNE (Etykiety / Y) ---
query_clin <- GDCquery(
project = "TCGA-LAML",
data.category = "Clinical",
data.type = "Clinical Supplement",
data.format = "BCR Biotab"
)
# Pobieranie do folderu GDCdata
GDCdownload(query_clin, directory = "GDCdata")
clinical_data <- GDCprepare(query_clin, directory = "GDCdata")
#Zosatwienie tylko klas od M0 to M5 ze wzgledu na małą liczbe probek dla M6 oraz M7
keep_fab <- c("M0 Undifferentiated", "M1", "M2", "M3", "M4", "M5")
# Główną tabela pacjentów
clinical_patient <- clinical_data$clinical_patient_laml
clinical_filtered <- subset(clinical_patient, fab_category%in%keep_fab)
message(paste("   Pobrano dane kliniczne dla", nrow(clinical_patient), "pacjentów."))
View(query_clin)
View(query_clin)
View(query_rna)
View(query_rna)
dim(data_rna)
View(clinical_filtered)
View(clinical_filtered)
colnames(data_rna) <- substr(colnames(data_rna), 1, 12)?
common_patients <- intersect(colnames(data_rna), clinical_filtered$bcr_patient_barcode)
colnames(data_rna) <- substr(colnames(data_rna), 1, 12)?
common_patients <- intersect(colnames(data_rna), clinical_filtered$bcr_patient_barcode)
message(paste("   Pobrano macierz ekspresji:", nrow(data_rna), "genów x", ncol(data_rna), "próbek."))
# Tryb 'api' i mniejsze paczki, aby uniknąć błędów sieciowych
GDCdownload(query_rna,
method = "api",
files.per.chunk = 10,
directory = "GDCdata")
data_rna <- GDCprepare(query_rna, directory = "GDCdata")
colnames(data_rna) <- substr(colnames(data_rna), 1, 12)?
common_patients <- intersect(colnames(data_rna), clinical_filtered$bcr_patient_barcode)
colnames(data_rna) <- substr(colnames(data_rna), 1, 12)?
common_patients <- intersect(colnames(data_rna), clinical_filtered$bcr_patient_barcode)
colnames(data_rna) <- substr(colnames(data_rna), 1, 12)
common_patients <- intersect(colnames(data_rna), clinical_filtered$bcr_patient_barcode)
message(paste("   Pobrano macierz ekspresji:", nrow(data_rna), "genów x", ncol(data_rna), "próbek."))
lenght(common_patients)
lengths(common_patients)
length(common_patients)
# SKRYPT 01: Data Download (TCGA-LAML)
# ------------------------------------------------------------------------------
# Pobranie danych klinicznych i transkryptomicznych (RNA-seq)
# Źródło: GDC (Genomic Data Commons)
# ------------------------------------------------------------------------------
library(TCGAbiolinks)
library(SummarizedExperiment)
message(">>> ROZPOCZYNANIE POBIERANIA DANYCH DLA PROJEKTU TCGA-LAML <<<")
# Utworzenie folderu na pliki tymczasowe
if(!dir.exists("GDCdata")) dir.create("GDCdata")
# --- 1. DANE KLINICZNE (Etykiety / Y) ---
query_clin <- GDCquery(
project = "TCGA-LAML",
data.category = "Clinical",
data.type = "Clinical Supplement",
data.format = "BCR Biotab"
)
# Pobieranie do folderu GDCdata
GDCdownload(query_clin, directory = "GDCdata")
clinical_data <- GDCprepare(query_clin, directory = "GDCdata")
#Zosatwienie tylko klas od M0 to M5 ze wzgledu na małą liczbe probek dla M6 oraz M7
keep_fab <- c("M0 Undifferentiated", "M1", "M2", "M3", "M4", "M5")
# Główną tabela pacjentów
clinical_patient <- clinical_data$clinical_patient_laml
clinical_filtered <- subset(clinical_patient, fab_category%in%keep_fab)
message(paste("   Pobrano dane kliniczne dla", nrow(clinical_patient), "pacjentów."))
# --- 2. DANE RNA-SEQ (Cechy / X) ---
message("2. Pobieranie danych RNA-seq (Gene Expression Quantification).")
query_rna <- GDCquery(
project = "TCGA-LAML",
data.category = "Transcriptome Profiling",
data.type = "Gene Expression Quantification",
workflow.type = "STAR - Counts"
)
# Tryb 'api' i mniejsze paczki, aby uniknąć błędów sieciowych
GDCdownload(query_rna,
method = "api",
files.per.chunk = 10,
directory = "GDCdata")
data_rna <- GDCprepare(query_rna, directory = "GDCdata")
colnames(data_rna) <- substr(colnames(data_rna), 1, 12)
common_patients <- intersect(colnames(data_rna), clinical_filtered$bcr_patient_barcode)
message(paste("   Pobrano macierz ekspresji:", nrow(data_rna), "genów x", ncol(data_rna), "próbek."))
# --- 3. ZAPIS SUROWYCH DANYCH ---
message("3. Zapisywanie danych do folderu data/raw/.")
if(!dir.exists("data/raw")) dir.create("data/raw", recursive = TRUE)
save(data_rna, clinical_filtered, file = "data/raw/TCGA_LAML_Raw.RData")
message(">>> Dane zostały zapisane w pliku 'data/raw/TCGA_LAML_Raw.RData'. <<<")
colnames(counts_matrix) <- substr(colnames(counts_matrix), 1, 12)
intersect(colnames(counts_matrix), clinical_filtered$bcr_patient_barcode)
common_patients <- intersect(colnames(counts_matrix), clinical_filtered$bcr_patient_barcode)
length(common_patients)
counts_matrix
View(counts_matrix)
clinical_filtered <- arrange(clinical_filtered, bcr_patient_barcode)
counts_matrix <- counts_martix[, clinical_filtered$bcr_patient_barcode]
clinical_filtered <- arrange(clinical_filtered, bcr_patient_barcode)
counts_matrix <- counts_martix[, clinical_filtered$bcr_patient_barcode]
# SKRYPT 02: Preprocessing (Czyszczenie i Normalizacja)
# ------------------------------------------------------------------------------
# Cel: Przygotowanie tabeli "ML-ready" z surowych danych.
# Input: data/raw/TCGA_LAML_Raw.RData
# Output: data/processed/TCGA_LAML_Cleaned.RData
# ------------------------------------------------------------------------------
library(SummarizedExperiment)
library(dplyr)
library(edgeR)
message(">>> PRZETWARZANIE DANYCH <<<")
# 1. WCZYTANIE SUROWYCH DANYCH
load("data/raw/TCGA_LAML_Raw.RData")
# Wyciągamy macierz (geny x próbki)
counts_matrix <- assay(data_rna)
message("Wczytano macierz: ", nrow(counts_matrix), " genów x ", ncol(counts_matrix), " próbek.")
keep_fab <- c("M0 Undifferentiated", "M1", "M2", "M3", "M4", "M5")
clinical_filtered <- subset(clinical_patient, fab_category%in%keep_fab)
colnames(counts_matrix) <- substr(colnames(counts_matrix), 1, 12)
intersect(colnames(counts_matrix), clinical_filtered$bcr_patient_barcode)
common_patients <- intersect(colnames(counts_matrix), clinical_filtered$bcr_patient_barcode)
length(common_patients)
clinical_filtered <- arrange(clinical_filtered, bcr_patient_barcode)
counts_matrix <- counts_martix[, clinical_filtered$bcr_patient_barcode]
counts_matrix <- counts_matrix[, clinical_filtered$bcr_patient_barcode]
counts_matrix <- counts_matrix[ , clinical_filtered$bcr_patient_barcode]
counts_matrix_new <- counts_matrix[ , clinical_filtered$bcr_patient_barcode]
# SKRYPT 02: Preprocessing (Czyszczenie i Normalizacja)
# ------------------------------------------------------------------------------
# Cel: Przygotowanie tabeli "ML-ready" z surowych danych.
# Input: data/raw/TCGA_LAML_Raw.RData
# Output: data/processed/TCGA_LAML_Cleaned.RData
# ------------------------------------------------------------------------------
library(SummarizedExperiment)
library(dplyr)
library(edgeR)
message(">>> PRZETWARZANIE DANYCH <<<")
# 1. WCZYTANIE SUROWYCH DANYCH
load("data/raw/TCGA_LAML_Raw.RData")
# Wyciągamy macierz (geny x próbki)
counts_matrix <- assay(data_rna)
message("Wczytano macierz: ", nrow(counts_matrix), " genów x ", ncol(counts_matrix), " próbek.")
keep_fab <- c("M0 Undifferentiated", "M1", "M2", "M3", "M4", "M5")
clinical_filtered <- subset(clinical_patient, fab_category%in%keep_fab)
colnames(counts_matrix) <- substr(colnames(counts_matrix), 1, 12)
intersect(colnames(counts_matrix), clinical_filtered$bcr_patient_barcode)
common_patients <- intersect(colnames(counts_matrix), clinical_filtered$bcr_patient_barcode)
length(common_patients)
clinical_filtered <- arrange(clinical_filtered, bcr_patient_barcode)
counts_matrix <- counts_matrix[ , clinical_filtered$bcr_patient_barcode]
head(colnames(counts_matrix))
dim(clinical_filtered)
dim(counts_matrix)
missing_patients <- setdiff(clinical_filtered$bcr_patient_barcode, colnames(counts_matrix))
print(missing_patients)
